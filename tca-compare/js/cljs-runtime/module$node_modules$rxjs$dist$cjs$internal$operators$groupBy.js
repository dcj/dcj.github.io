shadow$provide.module$node_modules$rxjs$dist$cjs$internal$operators$groupBy=function(global,require,module,exports){var __extends=this&&this.__extends||function(){var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,b$jscomp$0)};return function(d,b){function __(){this.constructor=d}extendStatics(d,
b);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:!0});exports.GroupedObservable=exports.groupBy=void 0;global=require("module$node_modules$rxjs$dist$cjs$internal$Subscriber");var Subscription_1=require("module$node_modules$rxjs$dist$cjs$internal$Subscription");module=require("module$node_modules$rxjs$dist$cjs$internal$Observable");var Subject_1=require("module$node_modules$rxjs$dist$cjs$internal$Subject"),lift_1=require("module$node_modules$rxjs$dist$cjs$internal$util$lift");
exports.groupBy=function(keySelector,elementSelector,durationSelector,subjectSelector){return function(source){return lift_1.lift(source,new GroupByOperator(keySelector,elementSelector,durationSelector,subjectSelector))}};var GroupByOperator=function(){function GroupByOperator(keySelector,elementSelector,durationSelector,subjectSelector){this.keySelector=keySelector;this.elementSelector=elementSelector;this.durationSelector=durationSelector;this.subjectSelector=subjectSelector}GroupByOperator.prototype.call=
function(subscriber,source){return source.subscribe(new GroupBySubscriber(subscriber,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))};return GroupByOperator}(),GroupBySubscriber=function(_super){function GroupBySubscriber(destination,keySelector,elementSelector,durationSelector,subjectSelector){destination=_super.call(this,destination)||this;destination.keySelector=keySelector;destination.elementSelector=elementSelector;destination.durationSelector=durationSelector;
destination.subjectSelector=subjectSelector;destination.groups=null;destination.attemptedToUnsubscribe=!1;destination.count=0;return destination}__extends(GroupBySubscriber,_super);GroupBySubscriber.prototype._next=function(value){try{var key=this.keySelector(value)}catch(err){this.error(err);return}this._group(value,key)};GroupBySubscriber.prototype._group=function(value,key){var groups=this.groups;groups||(groups=this.groups=new Map);var group=groups.get(key);if(this.elementSelector)try{var element=
this.elementSelector(value)}catch(err){this.error(err)}else element=value;if(!group&&(group=this.subjectSelector?this.subjectSelector():new Subject_1.Subject,groups.set(key,group),value=new GroupedObservable(key,group,this),this.destination.next(value),this.durationSelector)){value=void 0;try{value=this.durationSelector(new GroupedObservable(key,group))}catch(err$10){this.error(err$10);return}this.add(value.subscribe(new GroupDurationSubscriber(key,group,this)))}group.closed||group.next(element)};
GroupBySubscriber.prototype._error=function(err){var groups=this.groups;groups&&(groups.forEach(function(group,key){group.error(err)}),groups.clear());this.destination.error(err)};GroupBySubscriber.prototype._complete=function(){var groups=this.groups;groups&&(groups.forEach(function(group,key){group.complete()}),groups.clear());this.destination.complete()};GroupBySubscriber.prototype.removeGroup=function(key){this.groups.delete(key)};GroupBySubscriber.prototype.unsubscribe=function(){this.closed||
(this.attemptedToUnsubscribe=!0,0===this.count&&_super.prototype.unsubscribe.call(this))};return GroupBySubscriber}(global.Subscriber),GroupDurationSubscriber=function(_super){function GroupDurationSubscriber(key,group,parent){group=_super.call(this,group)||this;group.key=key;group.parent=parent;return group}__extends(GroupDurationSubscriber,_super);GroupDurationSubscriber.prototype._next=function(){this.complete()};GroupDurationSubscriber.prototype.unsubscribe=function(){if(!this.closed){var parent_1=
this.parent,key=this.key;this.key=this.parent=null;parent_1&&parent_1.removeGroup(key);_super.prototype.unsubscribe.call(this)}};return GroupDurationSubscriber}(global.Subscriber),GroupedObservable=function(_super){function GroupedObservable(key,groupSubject,refCountSubscription){var _this=_super.call(this)||this;_this.key=key;_this.groupSubject=groupSubject;_this.refCountSubscription=refCountSubscription;return _this}__extends(GroupedObservable,_super);GroupedObservable.prototype._subscribe=function(subscriber){var subscription=
new Subscription_1.Subscription,refCountSubscription=this.refCountSubscription,groupSubject=this.groupSubject;refCountSubscription&&!refCountSubscription.closed&&subscription.add(new InnerRefCountSubscription(refCountSubscription));subscription.add(groupSubject.subscribe(subscriber));return subscription};return GroupedObservable}(module.Observable);exports.GroupedObservable=GroupedObservable;var InnerRefCountSubscription=function(_super){function InnerRefCountSubscription(parent){var _this=_super.call(this)||
this;_this.parent=parent;parent.count++;return _this}__extends(InnerRefCountSubscription,_super);InnerRefCountSubscription.prototype.unsubscribe=function(){var parent=this.parent;parent.closed||this.closed||(_super.prototype.unsubscribe.call(this),--parent.count,0===parent.count&&parent.attemptedToUnsubscribe&&parent.unsubscribe())};return InnerRefCountSubscription}(Subscription_1.Subscription)}
//# sourceMappingURL=module$node_modules$rxjs$dist$cjs$internal$operators$groupBy.js.map
